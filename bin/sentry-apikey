#!/usr/bin/env ruby

require_relative '../lib/jsonserver'

module SentryConfig
  module_eval File.read(File.join(File.dirname($0), "..", "etc", "config"))
end

$DEBUG = true

keys = JSONServerKeys.new(SentryConfig::Daemon::Keys)
description = ARGV.shift
groups = ARGV.map { |g| g.to_sym }
entry = JSONServerKeyEntry.generate(description, groups)
keys.add(entry)
puts entry.key
